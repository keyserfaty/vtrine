{"version":3,"sources":["node_modules/browser-pack/_prelude.js","src/app.js","src/helpers/Node.js","src/helpers/store.js"],"names":["e","t","n","r","s","o","u","a","require","i","f","Error","code","l","exports","call","length","1","module","_Node","_store","d","document","initialState","searchValue","displayDownloads","imagesQueue","reducer","state","arguments","undefined","action","type","_extends","payload","filter","image","Number","id","store","createStore","searchInput","querySelector","body","header","folder","subscribe","console","log","arrow","Node","class","ul","content","images","button","footer","clear","title","_header","downloadsComponent","appendChild","dispatch","addEventListener","target","parentNode","attributes","nodeValue","downloadPreviousNode","removeChild","_content","_ul","_ul2","liListPrevious","querySelectorAll","forEach","li","map","style","window","keyCode","value","_app","elem","attrs","_len","children","Array","_key","node","createElement","Object","keys","key","setAttribute","child","innerHTML","_typeof","NodeSerializer","qty","_len2","_key2","list","push","apply","subscribers","handle","getState","handler"],"mappings":"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","file":"app.min.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","import { Node } from './helpers/Node'\nimport { createStore } from './helpers/store'\n\nexport const d = document\n\n// model\nconst initialState = {\n  searchValue: '',\n  displayDownloads: false,\n  imagesQueue: ['./statics/images/1.jpg', './statics/images/1.jpg']\n}\n\nconst reducer = (state = initialState, action) => {\n  switch (action.type) {\n    case 'ON_INPUT_ENTER_KEY_DOWN': {\n      return {\n        ...state,\n        searchValue: action.payload.searchValue,\n      }\n    }\n\n    case 'ON_TOGGLE_DOWNLOADS': {\n      return {\n        ...state,\n        displayDownloads: !state.displayDownloads,\n      }\n    }\n\n    case 'ON_CLEAR_ALL_DOWNLOADS': {\n      return {\n        ...state,\n        imagesQueue: [],\n      }\n    }\n\n    case 'ON_REMOVE_IMAGE_FROM_QUEUE': {\n      return {\n        ...state,\n        imagesQueue: state.imagesQueue.filter((image, i) => i !== Number(action.payload.id))\n      }\n    }\n\n    default:\n      return state\n  }\n}\n\nconst store = createStore(reducer)\n\n// view\nconst searchInput = d.querySelector('input')\nconst body = d.querySelector('body')\nconst header = d.querySelector('header')\nconst folder = header.querySelector('.downloads')\n\nstore.subscribe((state, action) => {\n  switch (action.type) {\n    case 'ON_INPUT_ENTER_KEY_DOWN': {\n      console.log('should redirect')\n      break\n    }\n\n    case 'ON_TOGGLE_DOWNLOADS': {\n      // Nodes creation\n      const arrow = Node('div', { class: 'arrow' })\n\n      const ul = Node('ul', null)\n      const content = Node('div', { class: 'content' }, ul)\n      const images = Node('div', { class: 'images' }, content)\n\n      const button = Node('button', null, 'Download selection')\n      const footer = Node('div', { class: 'footer' }, button)\n\n      const clear = Node('div', { class: 'clear' }, 'Clear all')\n      const title = Node('div', { class: 'title' }, 'My Collection')\n\n      const header = Node('div', { class: 'header' }, title, clear)\n      const downloadsComponent = Node('div', { id: 'download' }, header, arrow, images, footer)\n\n      // DOM changes\n      const displayDownloads = state.displayDownloads\n\n      if (displayDownloads) {\n        body.appendChild(downloadsComponent)\n        store.dispatch({ type: '_RENDER_IMAGES_QUEUE' })\n\n        clear.addEventListener('click', () => {\n          store.dispatch({ type: 'ON_CLEAR_ALL_DOWNLOADS' })\n        })\n\n        button.addEventListener('click', () => {\n          store.dispatch({ type: 'ON_DOWNLOAD_ALL_DOWNLOADS' })\n        })\n\n        ul.addEventListener('click', (e) => {\n          if (e.target.parentNode.id.length) {\n            if (e.target.attributes[0].nodeValue === 'remove') {\n              store.dispatch({ type: 'ON_REMOVE_IMAGE_FROM_QUEUE', payload: { id: e.target.parentNode.id } })\n            }\n\n            if (e.target.attributes[0].nodeValue === 'download') {\n              store.dispatch({ type: 'ON_DOWNLOAD_IMAGE_FROM_QUEUE', payload: { id: e.target.parentNode.id } })\n            }\n          }\n        })\n      } else {\n        const downloadPreviousNode = d.querySelector('#download')\n        body.removeChild(downloadPreviousNode)\n      }\n\n      break\n    }\n\n    case 'ON_CLEAR_ALL_DOWNLOADS': {\n      const content = body.querySelector('#download .content')\n      const ul = content.querySelector('ul')\n\n      if (ul != null) {\n        content.removeChild(ul)\n      }\n\n      break\n    }\n\n    /*\n    Optimizations in order:\n    1) Detect when component is attached to a state change and only then\n    re-render on state change. The rest of the elements should remain intact\n    2) Detect which elements in a list of elements have changed (for example:\n    in this case I shouldn't need to re-render all `li` elements, I should only\n    remove the removed ones or change the changed ones. Could use a hash table for that?\n     */\n    case '_RENDER_IMAGES_QUEUE':\n    case 'ON_REMOVE_IMAGE_FROM_QUEUE': {\n      // Clean DOM\n      const ul = body.querySelector('#download .content ul')\n      const liListPrevious = ul.querySelectorAll('li')\n\n      if (liListPrevious != null) {\n        liListPrevious.forEach(li => ul.removeChild(li))\n      }\n\n      // Build DOM\n      const imagesQueue = state.imagesQueue\n      const liList = imagesQueue.map((image, i) =>\n        Node('li', { class: 'image', style: `background: url('${image}')` },\n          Node('div', { class: 'actions', id: i },\n            Node('div', { class: 'remove' }), Node('div', { class: 'download' })))\n      )\n\n      liList.forEach(li => ul.appendChild(li))\n\n      break\n    }\n  }\n})\n\n// events\nwindow.addEventListener('load', () => {\n  store.dispatch({ type: 'ON_WINDOW_LOAD' })\n})\n\nsearchInput.addEventListener('keyup', e => {\n  if (e.keyCode === 13) {\n    store.dispatch({\n      type: 'ON_INPUT_ENTER_KEY_DOWN',\n      payload: {\n        searchValue: e.target.value,\n      }\n    })\n  }\n})\n\nfolder.addEventListener('click', () => {\n  store.dispatch({ type: 'ON_TOGGLE_DOWNLOADS' })\n})","import { d } from '../app'\n\nexport const Node = (elem, attrs, ...children) => {\n  let node = d.createElement(elem)\n\n  if (attrs != null) {\n    Object.keys(attrs).forEach(key => {\n      node.setAttribute(key, attrs[key])\n    })\n  }\n\n  if (children.length > 0) {\n    children.forEach(child => {\n      if (typeof child === 'string') {\n        node.innerHTML = child\n      }\n\n      if (typeof child === 'object') {\n        node.appendChild(child)\n      }\n    })\n  }\n\n  return node\n}\n\n// TODO: won't work with same child props. Works only the first time\nexport const NodeSerializer = (qty, ...node) => {\n  let list = []\n  for (let i = 0; i < qty; i++) {\n    list.push(Node(...node))\n  }\n\n  return list\n}\n","export const createStore = function createStoreFn (reducer) {\n  let state = undefined\n  let subscribers = []\n\n  return {\n    dispatch: function (action) {\n      state = reducer(state, action)\n      console.log(action, state)\n      subscribers.forEach(function (handle) {\n        return handle(state, action)\n      })\n    },\n    getState: function () {\n      return state\n    },\n    subscribe: function (handler) {\n      subscribers.push(handler)\n    }\n  }\n}\n"]}