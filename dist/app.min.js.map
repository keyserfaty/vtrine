{"version":3,"sources":["node_modules/browser-pack/_prelude.js","src/app.js","src/components/Downloads.js","src/components/Full.js","src/components/OnBoarding.js","src/components/SaveIcon.js","src/components/SearchBoxHeader.js","src/components/SearchBoxMain.js","src/constants.js","src/helpers/Node.js","src/helpers/index.js","src/helpers/store.js","src/reducer.js"],"names":["e","t","n","r","s","o","u","a","require","i","f","Error","code","l","exports","call","length","1","module","_reducer","_helpers","_constants","_Downloads","_SearchBoxMain","_SearchBoxHeader","_OnBoarding","_SaveIcon","_Full","d","document","body","querySelector","header","actions","folder","image","footer","store","subscribe","state","action","props","_extends","dispatch","searchBoxMainPreviousNode","routes","path","exists","appendChild","_SearchBoxMain2","default","parentNode","removeChild","searchBoxHeaderNode","localStorage","getItem","insertBefore","_SearchBoxHeader2","downloadPreviousNode","downloadFullNode","displayDownloads","_Downloads2","imagesQueue","_Full2","userNode","userPhotoNode","userNameNode","currentImage","src","then","setAttribute","color","classList","add","user","profile_image","small","innerText","name","isTwoImagesAwayFromEnd","currentImageId","imagesList","isNotInNewPage","currentPage","haveNotFetchedAllImages","totalImages","type","payload","window","history","pushState","searchValue","isNavigating","some","id","_SaveIcon2","setTimeout","saveIconNode","xml","XMLHttpRequest","addEventListener","images","JSON","parse","this","responseText","open","url","send","searchBoxHeaderInputNode","blur","keyCode","_Node","Downloads","clearOnClick","buttonOnClick","ulOnClick","target","attributes","nodeValue","Node","class","onClick","apply","undefined","concat","_toConsumableArray","map","style","urls","thumb","Full","OnBoarding","SaveIcon","SearchBoxHeader","onSearchBoxFocus","onSearchBoxBlur","onKeyupInput","value","onKeyUp","onFocus","onBlur","SearchBoxMain","placeholder","autofocus","clientId","page","query","_app","EVENTS","onLoad","elem","attrs","_len","arguments","children","Array","_key","node","createElement","Object","keys","forEach","key","hasOwnProperty","child","innerHTML","_typeof","imageLoader","Promise","resolve","reject","img","Image","onload","onerror","err","preCachedImages","createStore","reducer","subscribers","console","log","handle","getState","handler","push","_store","initialState","nextImage","totalPages","filter","Number","isNewRequest","results","imagesFromList","item","preCacheImages","total_pages","total"],"mappings":"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","file":"app.min.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","import { store } from './reducer'\n\nimport { exists, preCachedImages } from './helpers'\nimport { url } from './constants'\n\nimport Downloads from './components/Downloads'\nimport SearchBoxMain from './components/SearchBoxMain'\nimport SearchBoxHeader from './components/SearchBoxHeader'\nimport OnBoarding from './components/OnBoarding'\nimport SaveIcon from './components/SaveIcon'\nimport Full from './components/Full'\n\nexport const d = document\n\n// view\nconst body = d.querySelector('body')\nconst header = d.querySelector('header')\nconst actions = header.querySelector('.actions')\nconst folder = header.querySelector('.downloads')\nconst image = body.querySelector('.image')\nconst footer = body.querySelector('footer')\n\nstore.subscribe((state, action) => {\n  const props = {\n    dispatch: store.dispatch,\n    ...state,\n  }\n\n  // route changes\n  const searchBoxMainPreviousNode = d.querySelector('#search')\n  const onBoardingNode = image.querySelector('#on-boarding')\n\n  if (state.routes.path === '/' && !exists(searchBoxMainPreviousNode)) {\n    image.appendChild(SearchBoxMain(props))\n  }\n\n  if (state.routes.path !== '/' && exists(searchBoxMainPreviousNode)) {\n    searchBoxMainPreviousNode.parentNode.removeChild(searchBoxMainPreviousNode)\n  }\n\n  const isFirstLoad = localStorage.getItem('first_load')\n  const searchBoxHeaderNode = header.querySelector('.search')\n\n  if (state.routes.path === '/search' && !exists(searchBoxHeaderNode)) {\n    header.insertBefore(SearchBoxHeader(props), actions)\n  }\n\n  //if (state.routes.path === '/search' && !exists(onBoardingNode) && !exists(isFirstLoad)) {\n  //  image.appendChild(OnBoarding(props))\n  //  localStorage.setItem('first_load', false)\n  //}\n\n  // imagesQueue changes\n  const downloadPreviousNode = d.querySelector('#download')\n  const downloadFullNode = folder.querySelector('.full')\n\n  if (state.displayDownloads && exists(downloadPreviousNode)) {\n    downloadPreviousNode.parentNode.removeChild(downloadPreviousNode)\n    body.appendChild(Downloads(props))\n  }\n\n  if (state.imagesQueue.length > 0 && !exists(downloadFullNode)) {\n    folder.appendChild(Full(props))\n  }\n\n  if (state.imagesQueue.length === 0 && exists(downloadFullNode)) {\n    downloadFullNode.parentNode.removeChild(downloadFullNode)\n  }\n\n  // displayDownloads changes\n  if (state.displayDownloads && !exists(downloadPreviousNode)) {\n    body.appendChild(Downloads(props))\n  }\n\n  if (!state.displayDownloads && exists(downloadPreviousNode)) {\n    downloadPreviousNode.parentNode.removeChild(downloadPreviousNode)\n  }\n\n  const userNode = footer.querySelector('.user')\n  const userPhotoNode = userNode.querySelector('.photo')\n  const userNameNode = userNode.querySelector('.name')\n\n  // imagesList changes\n  if (exists(state.currentImage)) {\n    state.currentImage.src.then(src => {\n      image.setAttribute('style', `background: ${state.currentImage.color} url('${src}') no-repeat; background-size: cover;`)\n    })\n\n    image.classList.add('loading')\n    userPhotoNode.setAttribute('style', 'background-image: url(' + state.currentImage.user.profile_image.small +')')\n    userNameNode.innerText = state.currentImage.user.name\n  }\n\n  // requesting new images\n  const isTwoImagesAwayFromEnd = state.currentImageId === state.imagesList.length - 2\n  const isNotInNewPage = state.imagesList.length / 10 === state.currentPage\n  const haveNotFetchedAllImages = state.imagesList.length !== state.totalImages\n\n  if (isTwoImagesAwayFromEnd && isNotInNewPage && haveNotFetchedAllImages) {\n    store.dispatch({\n      type: 'ON_FETCH_IMAGES',\n      payload: {\n        currentPage: state.currentPage + 1\n      }\n    })\n  }\n\n  if (state.currentImageId + 1 === state.imagesList.length && state.imagesList.length !== 0) {\n    store.dispatch({\n      type: 'ON_END_OF_LIST'\n    })\n  }\n\n  switch (action.type) {\n    case 'ON_INPUT_ENTER_KEY_DOWN': {\n      window.history.pushState('', '', 'search?q=' + state.searchValue)\n      store.dispatch({\n        type: 'ON_FETCH_IMAGES',\n        payload: {\n          currentPage: 1\n        }\n      })\n      break\n    }\n\n    case 'ON_KEY_UP_SPACE_BAR': {\n      if (!state.isNavigating) break\n      store.dispatch({ type: 'ON_LOAD_NEXT_IMAGE' })\n\n      break\n    }\n\n    case 'ON_KEY_UP_S': {\n      if (!state.isNavigating) break\n      if (state.imagesQueue.some(image => image.id === state.currentImage.id)) break\n\n      store.dispatch({ type: 'ON_ADD_IMAGE_TO_QUEUE' })\n\n      break\n    }\n\n    case 'ON_ADD_IMAGE_TO_QUEUE': {\n      body.insertBefore(SaveIcon(props), header)\n\n      setTimeout(() => {\n        const saveIconNode = body.querySelector('#save')\n        saveIconNode.parentNode.removeChild(saveIconNode)\n      }, 300)\n\n      break\n    }\n\n    case 'ON_FETCH_IMAGES': {\n      const xml = new XMLHttpRequest();\n\n      xml.addEventListener('load', function () {\n          store.dispatch({\n            type: 'ON_FETCH_IMAGES_SUCCESS',\n            payload: {\n              images: JSON.parse(this.responseText)\n            }\n          })\n        }\n      );\n      xml.open('GET', url(state.currentPage, state.searchValue));\n      xml.send();\n\n      break\n    }\n\n    case 'ON_FETCH_IMAGES_SUCCESS': {\n      const searchBoxHeaderInputNode = searchBoxHeaderNode.querySelector('input')\n      if (exists(searchBoxHeaderInputNode)) {\n        searchBoxHeaderInputNode.blur()\n      }\n\n      break\n    }\n\n    default:\n      return false\n  }\n})\n\n// events\nwindow.addEventListener('load', () => {\n  store.dispatch({ type: 'ON_WINDOW_LOAD' })\n})\n\nwindow.addEventListener('keyup', (e) => {\n  if (e.keyCode === 32) {\n    store.dispatch({\n      type: 'ON_KEY_UP_SPACE_BAR'\n    })\n  }\n\n  if (e.keyCode === 83) {\n    store.dispatch({\n      type: 'ON_KEY_UP_S'\n    })\n  }\n})\n\nfolder.addEventListener('click', () => {\n  store.dispatch({ type: 'ON_TOGGLE_DOWNLOADS' })\n})\n","import { Node } from '../helpers/Node'\n\nconst Downloads = props => {\n  const {\n    dispatch,\n    imagesQueue,\n  } = props\n\n  // Events\n  const clearOnClick = () => {\n    dispatch({ type: 'ON_CLEAR_ALL_DOWNLOADS' })\n  }\n\n  const buttonOnClick = () => {\n    dispatch({ type: 'ON_DOWNLOAD_ALL_DOWNLOADS' })\n  }\n\n  const ulOnClick = e => {\n    if (e.target.parentNode.id.length) {\n      if (e.target.attributes[0].nodeValue === 'remove') {\n        dispatch({type: 'ON_REMOVE_IMAGE_FROM_QUEUE', payload: {id: e.target.parentNode.id}})\n      }\n\n      if (e.target.attributes[0].nodeValue === 'download') {\n        dispatch({type: 'ON_DOWNLOAD_IMAGE_FROM_QUEUE', payload: {id: e.target.parentNode.id}})\n      }\n    }\n  }\n\n  // DOM\n  return (\n    Node('div', { id: 'download' },\n      Node('div', { class: 'header' },\n        Node('div', { class: 'title' }, 'My Collection'),\n        Node('div', { class: 'clear', onClick: clearOnClick }, 'Clear all')),\n      Node('div', { class: 'arrow' }),\n      Node('div', { class: 'images' },\n        Node('div', { class: 'content' },\n          Node('ul', { onClick: ulOnClick },\n            ...imagesQueue.map((image, i) =>\n              Node('li', { class: 'image', style: `background: url('${image.urls.thumb}')` },\n                Node('div', { class: 'actions', id: i },\n                  Node('div', { class: 'remove' }), Node('div', { class: 'download' })))\n            )))),\n      Node('div', { class: 'footer' },\n        Node('button', { onClick: buttonOnClick }, 'Download selection')\n      )\n    )\n  )\n}\n\nexport default Downloads\n","import { Node } from '../helpers/Node'\n\nconst Full = () => {\n  return (\n    Node('div', { class: 'full' })\n  )\n}\n\nexport default Full\n","import { Node } from '../helpers/Node'\n\nconst OnBoarding = props => {\n  return (\n    Node('div', { id: 'on-boarding' },\n      Node('div', { class: 'image' }),\n      Node('div', { class: 'caption' }, 'Press spacebar to generate a photo'),\n      Node('div', { class: 'footer' },\n        Node('div', { class: 'skip' }, 'Skip'),\n        Node('div', { class: 'nav' },\n          Node('ul', null,\n            Node('li'), Node('li'), Node('li'))),\n        Node('div', { class: 'next' }, 'Next')))\n  )\n}\n\nexport default OnBoarding\n","import { Node } from '../helpers/Node'\n\nconst SaveIcon = () => {\n  return (\n    Node('div', { id: 'save' },\n      Node('i', { class: 'icon' })\n    )\n  )\n}\n\nexport default SaveIcon\n","import { Node } from '../helpers/Node'\n\nconst SearchBoxHeader = props => {\n  const { dispatch, searchValue } = props\n\n  const onSearchBoxFocus = () => {\n    dispatch({ type: 'ON_HEADER_SEARCH_BOX_FOCUS' })\n  }\n\n  const onSearchBoxBlur = () => {\n    dispatch({ type: 'ON_HEADER_SEARCH_BOX_BLUR' })\n  }\n\n  const onKeyupInput = e => {\n    if (e.keyCode === 13) {\n      dispatch({\n        type: 'ON_INPUT_ENTER_KEY_DOWN',\n        payload: {\n          searchValue: e.target.value,\n        }\n      })\n    }\n  }\n\n  return (\n    Node('div', { class: 'search' },\n      Node('div', { class: 'search-box' },\n        Node('i', { class: 'icon' }),\n        Node('input', { type: 'text', value: searchValue, onKeyUp: onKeyupInput, onFocus: onSearchBoxFocus, onBlur: onSearchBoxBlur })\n      )\n    )\n  )\n}\n\nexport default SearchBoxHeader\n","import { Node } from '../helpers/Node'\n\nconst SearchBoxMain = props => {\n  const { dispatch } = props\n\n  const onKeyupInput = e => {\n    if (e.keyCode === 13) {\n      dispatch({\n        type: 'ON_INPUT_ENTER_KEY_DOWN',\n        payload: {\n          searchValue: e.target.value,\n        }\n      })\n    }\n  }\n\n  return (\n    Node('div', { id: 'search' },\n      Node('div', { class: 'search-box', onKeyUp: onKeyupInput },\n        Node('div', { class: 'icon' }),\n        Node('input', { type: 'text', placeholder: 'Search photos', autofocus: true }))\n    )\n  )\n}\n\nexport default SearchBoxMain\n","export const clientId = '6322e07de0e155ba0d9eca8d67cf27bb9b45417f2feb1a234baa363a1dda3dbe'\nexport const url = (page, query) => `https://api.unsplash.com/search/photos?client_id=${clientId}&page=${page}&query=${query}`\n","import { d } from '../app'\n\nconst EVENTS = {\n  onClick: 'click',\n  onKeyUp: 'keyup',\n  onLoad: 'load',\n  onFocus: 'focus',\n  onBlur: 'blur'\n}\n\nexport const Node = (elem, attrs, ...children) => {\n  let node = d.createElement(elem)\n\n  if (attrs != null) {\n    Object.keys(attrs).forEach(key => {\n      if (EVENTS.hasOwnProperty(key)) {\n        node.addEventListener(EVENTS[key], attrs[key])\n      } else {\n        node.setAttribute(key, attrs[key])\n      }\n    })\n  }\n\n  if (children.length > 0) {\n    children.forEach(child => {\n      if (typeof child === 'string') {\n        node.innerHTML = child\n      }\n\n      if (typeof child === 'object') {\n        node.appendChild(child)\n      }\n    })\n  }\n\n  return node\n}\n","export const exists = node => node != null\n\nconst imageLoader = src => {\n  return new Promise(function (resolve, reject) {\n    let img = new Image()\n    img.onload = function () {\n      resolve(src)\n    }\n    img.onerror = function (err) {\n      reject(err)\n    }\n    img.src = src\n  })\n}\n\n/**\n * Takes a list of images urls and returns a list\n * of promises of images loading\n * @param images\n */\nexport const preCachedImages = images => images\n  .map(image => imageLoader(image))\n","export const createStore = function createStoreFn (reducer) {\n  let state = undefined\n  let subscribers = []\n\n  return {\n    dispatch: function (action) {\n      state = reducer(state, action)\n      console.log(action, state)\n      subscribers.forEach(function (handle) {\n        return handle(state, action)\n      })\n    },\n    getState: function () {\n      return state\n    },\n    subscribe: function (handler) {\n      subscribers.push(handler)\n    }\n  }\n}\n","import { createStore } from './helpers/store'\nimport { preCachedImages } from './helpers'\n\n// model\nconst initialState = {\n  // routing\n  routes: {\n    path: '/'\n  },\n\n  // ui\n  searchValue: '',\n  displayDownloads: false,\n  isNavigating: false,\n  imagesQueue: [],\n  currentImage: null,\n  currentImageId: 0,\n  nextImage: null,\n\n  // async\n  imagesList: [],\n  preCachedImages: [],\n  currentPage: null,\n  totalPages: null,\n  totalImages: null\n}\n\nconst reducer = (state = initialState, action) => {\n  switch (action.type) {\n    case 'ON_INPUT_ENTER_KEY_DOWN': {\n      return {\n        ...state,\n        searchValue: action.payload.searchValue,\n        routes: {\n          path: '/search'\n        }\n      }\n    }\n\n    case 'ON_HEADER_SEARCH_BOX_FOCUS': {\n      return {\n        ...state,\n        isNavigating: false,\n      }\n    }\n\n    case 'ON_HEADER_SEARCH_BOX_BLUR': {\n      return {\n        ...state,\n        isNavigating: true,\n      }\n    }\n\n    case 'ON_TOGGLE_DOWNLOADS': {\n      return {\n        ...state,\n        displayDownloads: !state.displayDownloads,\n      }\n    }\n\n    case 'ON_CLEAR_ALL_DOWNLOADS': {\n      return {\n        ...state,\n        imagesQueue: [],\n      }\n    }\n\n    case 'ON_ADD_IMAGE_TO_QUEUE': {\n      return {\n        ...state,\n        imagesQueue: [\n          ...state.imagesQueue,\n          state.currentImage\n        ]\n      }\n    }\n\n    case 'ON_REMOVE_IMAGE_FROM_QUEUE': {\n      return {\n        ...state,\n        imagesQueue: state.imagesQueue\n        .filter((image, i) => i !== Number(action.payload.id))\n      }\n    }\n\n    case 'ON_END_OF_LIST': {\n      return {\n        ...state,\n        currentImageId: 0\n      }\n    }\n\n    case 'ON_FETCH_IMAGES': {\n      return {\n        ...state,\n        currentPage: action.payload.currentPage\n      }\n    }\n\n    case 'ON_FETCH_IMAGES_SUCCESS': {\n      const isNewRequest = state.currentPage === 1\n\n      const currentImageId = isNewRequest\n        ? 0\n        : state.currentImageId\n\n      const imagesList = isNewRequest\n        ? action.payload.images.results\n        : [\n          ...state.imagesList,\n          ...action.payload.images.results\n        ]\n\n      // pre-cache images\n      const imagesFromList = imagesList.map(item => item.urls.thumb)\n      const preCacheImages = preCachedImages(imagesFromList)\n\n      return {\n        ...state,\n        imagesList,\n        currentImageId,\n        currentImage: {\n          ...imagesList[currentImageId],\n          src: preCacheImages[currentImageId]\n        },\n        preCacheImages,\n        isNavigating: true,\n        totalPages: action.payload.images.total_pages,\n        totalImages: action.payload.images.total\n      }\n    }\n\n    case 'ON_LOAD_NEXT_IMAGE': {\n      return {\n        ...state,\n        currentImage: {\n          ...state.imagesList[state.currentImageId + 1],\n          src: state.preCacheImages[state.currentImageId + 1]\n        },\n        currentImageId: state.currentImageId + 1\n      }\n    }\n\n    default:\n      return state\n  }\n}\n\nexport const store = createStore(reducer)\n"]}